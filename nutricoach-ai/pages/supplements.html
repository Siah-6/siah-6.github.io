<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#0A1628">
    <title>Supplements - NutriCoach AI</title>
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/dark-theme.css">
    <link rel="stylesheet" href="../assets/css/supplements.css">
</head>
<body class="dark-theme">
    <div class="supplements-container">
        <!-- Header -->
        <div class="supplements-header">
            <button class="back-btn" onclick="window.history.back()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
            </button>
            <div class="header-title">
                <h1>üíä Supplements</h1>
                <p>Personalized recommendations & guide</p>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs-container">
            <button class="tab-btn active" data-tab="ai-plan">My Plan</button>
            <button class="tab-btn" data-tab="library">Library</button>
        </div>

        <!-- AI Plan Tab -->
        <div class="tab-content active" id="ai-plan">
            <div class="ai-plan-section">
                <div class="plan-header">
                    <h2>ü§ñ AI Recommended For You</h2>
                    <p>Based on your goal: <strong>Build Muscle</strong></p>
                </div>

                <!-- Loading State -->
                <div class="loading-state" id="loadingPlan" style="display: none;">
                    <div class="spinner"></div>
                    <p>Analyzing your profile...</p>
                </div>

                <!-- Recommendations List -->
                <div class="recommendations-list" id="recommendationsList">
                    <!-- Will be populated by JavaScript -->
                </div>

                <button class="btn-regenerate" id="regenerateBtn" style="display: none;">
                    üîÑ Regenerate Recommendations
                </button>
            </div>
        </div>

        <!-- Library Tab -->
        <div class="tab-content" id="library">
            <div class="library-section">
                <div class="search-box">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"/>
                        <path d="M21 21l-4.35-4.35"/>
                    </svg>
                    <input type="text" id="searchInput" placeholder="Search supplements...">
                </div>

                <div class="categories">
                    <button class="category-btn active" data-category="all">All</button>
                    <button class="category-btn" data-category="protein">Protein</button>
                    <button class="category-btn" data-category="performance">Performance</button>
                    <button class="category-btn" data-category="recovery">Recovery</button>
                    <button class="category-btn" data-category="health">Health</button>
                </div>

                <div class="supplements-grid" id="supplementsGrid">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Supplement Database
        const supplementsDB = [
            {
                id: 1,
                name: "Whey Protein",
                icon: "ü•§",
                category: "protein",
                shortDesc: "Fast-absorbing protein for muscle growth",
                benefits: ["Muscle recovery", "Muscle growth", "Convenient protein source"],
                timing: "Post-workout or between meals",
                dosage: "25-30g per serving",
                bestFor: ["Muscle Gain", "Weight Loss"],
                safety: "Generally safe. Avoid if lactose intolerant.",
                science: "Highly researched and proven effective for muscle protein synthesis."
            },
            {
                id: 2,
                name: "Creatine Monohydrate",
                icon: "üí™",
                category: "performance",
                shortDesc: "Increases strength and muscle mass",
                benefits: ["Increased strength", "Muscle growth", "Improved performance"],
                timing: "Daily, anytime (consistency matters)",
                dosage: "5g per day",
                bestFor: ["Muscle Gain", "Strength"],
                safety: "Very safe and well-researched.",
                science: "One of the most studied and effective supplements."
            },
            {
                id: 3,
                name: "Omega-3 Fish Oil",
                icon: "üêü",
                category: "health",
                shortDesc: "Supports heart, brain, and joint health",
                benefits: ["Reduced inflammation", "Joint health", "Heart health", "Brain function"],
                timing: "With meals",
                dosage: "1-2g EPA+DHA daily",
                bestFor: ["General Health", "Recovery"],
                safety: "Safe for most people.",
                science: "Strong evidence for cardiovascular and anti-inflammatory benefits."
            },
            {
                id: 4,
                name: "Caffeine",
                icon: "‚òï",
                category: "performance",
                shortDesc: "Boosts energy, focus, and performance",
                benefits: ["Increased energy", "Enhanced focus", "Improved endurance", "Fat burning"],
                timing: "30-60 min before workout",
                dosage: "200-400mg",
                bestFor: ["Performance", "Weight Loss"],
                safety: "Safe in moderation. Avoid if sensitive to caffeine.",
                science: "Well-researched ergogenic aid."
            },
            {
                id: 5,
                name: "Beta-Alanine",
                icon: "‚ö°",
                category: "performance",
                shortDesc: "Delays muscle fatigue during training",
                benefits: ["Increased endurance", "Delayed fatigue", "More reps"],
                timing: "Pre-workout",
                dosage: "2-5g per day",
                bestFor: ["Muscle Gain", "Endurance"],
                safety: "Safe. May cause tingling sensation.",
                science: "Proven to improve high-intensity exercise performance."
            },
            {
                id: 6,
                name: "BCAAs",
                icon: "üîó",
                category: "recovery",
                shortDesc: "Branched-chain amino acids for recovery",
                benefits: ["Muscle recovery", "Reduced soreness", "Prevents breakdown"],
                timing: "During or post-workout",
                dosage: "5-10g",
                bestFor: ["Recovery", "Muscle Gain"],
                safety: "Safe for most people.",
                science: "Beneficial for recovery, especially during fasted training."
            },
            {
                id: 7,
                name: "Vitamin D",
                icon: "‚òÄÔ∏è",
                category: "health",
                shortDesc: "Essential for bone health and immunity",
                benefits: ["Bone health", "Immune function", "Mood support", "Testosterone"],
                timing: "Morning with food",
                dosage: "1000-4000 IU daily",
                bestFor: ["General Health"],
                safety: "Very safe at recommended doses.",
                science: "Many people are deficient. Important for overall health."
            },
            {
                id: 8,
                name: "Multivitamin",
                icon: "üíä",
                category: "health",
                shortDesc: "Covers nutritional gaps in your diet",
                benefits: ["Nutritional insurance", "Overall health", "Energy support"],
                timing: "Morning with breakfast",
                dosage: "As directed on label",
                bestFor: ["General Health"],
                safety: "Safe when used as directed.",
                science: "Helpful for covering micronutrient gaps."
            },
            {
                id: 9,
                name: "Pre-Workout",
                icon: "üöÄ",
                category: "performance",
                shortDesc: "Complete formula for energy and pumps",
                benefits: ["Energy boost", "Better pumps", "Enhanced focus", "Increased endurance"],
                timing: "20-30 min before workout",
                dosage: "As directed (usually 1 scoop)",
                bestFor: ["Performance", "Muscle Gain"],
                safety: "Check ingredients. Avoid if sensitive to stimulants.",
                science: "Combination of proven ingredients like caffeine, beta-alanine, citrulline."
            },
            {
                id: 10,
                name: "Casein Protein",
                icon: "üåô",
                category: "protein",
                shortDesc: "Slow-digesting protein for overnight recovery",
                benefits: ["Sustained protein release", "Muscle recovery", "Prevents breakdown"],
                timing: "Before bed",
                dosage: "25-40g",
                bestFor: ["Muscle Gain"],
                safety: "Safe. Avoid if lactose intolerant.",
                science: "Slow digestion makes it ideal for nighttime use."
            }
        ];

        let currentCategory = 'all';
        let currentTab = 'ai-plan';

        // Tab Switching
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tab = btn.dataset.tab;
                
                // Update buttons
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                // Update content
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                document.getElementById(tab).classList.add('active');
                
                currentTab = tab;
                
                if (tab === 'ai-plan' && document.getElementById('recommendationsList').children.length === 0) {
                    generateAIRecommendations();
                } else if (tab === 'library' && document.getElementById('supplementsGrid').children.length === 0) {
                    displaySupplements();
                }
            });
        });

        // Generate AI Recommendations (No chat history)
        async function generateAIRecommendations() {
            const loadingState = document.getElementById('loadingPlan');
            const recommendationsList = document.getElementById('recommendationsList');
            const regenerateBtn = document.getElementById('regenerateBtn');
            
            loadingState.style.display = 'block';
            recommendationsList.style.display = 'none';
            
            // Simulate loading (purely client-side, no API calls)
            setTimeout(() => {
                const userGoal = 'build muscle';
                displayAIRecommendations(userGoal);
                loadingState.style.display = 'none';
                recommendationsList.style.display = 'block';
                regenerateBtn.style.display = 'block';
            }, 800);
        }

        function displayAIRecommendations(userGoal) {
            const container = document.getElementById('recommendationsList');
            container.innerHTML = '';
            
            let recommendations = [];
            
            // Goal-based recommendations
            if (userGoal.includes('muscle') || userGoal.includes('gain') || userGoal.includes('bulk')) {
                recommendations = [1, 2, 5, 6]; // Whey, Creatine, Beta-Alanine, BCAAs
            } else if (userGoal.includes('weight') || userGoal.includes('fat') || userGoal.includes('lose')) {
                recommendations = [1, 4, 3, 7]; // Whey, Caffeine, Omega-3, Vitamin D
            } else if (userGoal.includes('strength')) {
                recommendations = [2, 1, 9, 5]; // Creatine, Whey, Pre-Workout, Beta-Alanine
            } else {
                recommendations = [1, 2, 3, 8]; // Whey, Creatine, Omega-3, Multivitamin
            }
            
            // Get supplements by ID
            recommendations.forEach(id => {
                const supp = supplementsDB.find(s => s.id === id);
                if (supp) {
                    const card = createRecommendationCard(supp);
                    container.appendChild(card);
                }
            });
        }

        function createRecommendationCard(supp) {
            const card = document.createElement('div');
            card.className = 'recommendation-card';
            card.innerHTML = `
                <div class="rec-header">
                    <div class="rec-icon">${supp.icon}</div>
                    <div class="rec-title">
                        <h3>${supp.name}</h3>
                        <p>${supp.shortDesc}</p>
                    </div>
                </div>
                <div class="rec-benefits">
                    ${supp.benefits.slice(0, 3).map(b => `<span class="benefit-tag">‚úì ${b}</span>`).join('')}
                </div>
                <div class="rec-details">
                    <div class="rec-detail">
                        <strong>‚è∞ When:</strong> ${supp.timing}
                    </div>
                    <div class="rec-detail">
                        <strong>üíä Dosage:</strong> ${supp.dosage}
                    </div>
                </div>
                <button class="btn-learn-more" onclick="showSupplementDetails(${supp.id})">
                    Learn More
                </button>
            `;
            return card;
        }

        // Display Library
        function displaySupplements(category = 'all', searchTerm = '') {
            const grid = document.getElementById('supplementsGrid');
            grid.innerHTML = '';
            
            let filtered = supplementsDB;
            
            if (category !== 'all') {
                filtered = filtered.filter(s => s.category === category);
            }
            
            if (searchTerm) {
                filtered = filtered.filter(s => 
                    s.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    s.shortDesc.toLowerCase().includes(searchTerm.toLowerCase())
                );
            }
            
            filtered.forEach(supp => {
                const card = document.createElement('div');
                card.className = 'supplement-card';
                card.onclick = () => showSupplementDetails(supp.id);
                card.innerHTML = `
                    <div class="supp-icon">${supp.icon}</div>
                    <h3>${supp.name}</h3>
                    <p>${supp.shortDesc}</p>
                    <div class="supp-category">${supp.category}</div>
                `;
                grid.appendChild(card);
            });
            
            if (filtered.length === 0) {
                grid.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 2rem;">No supplements found</p>';
            }
        }

        // Category Filter
        document.querySelectorAll('.category-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentCategory = btn.dataset.category;
                displaySupplements(currentCategory, document.getElementById('searchInput').value);
            });
        });

        // Search
        document.getElementById('searchInput').addEventListener('input', (e) => {
            displaySupplements(currentCategory, e.target.value);
        });

        // Regenerate
        document.getElementById('regenerateBtn').addEventListener('click', generateAIRecommendations);

        // Show Details Modal
        function showSupplementDetails(id) {
            const supp = supplementsDB.find(s => s.id === id);
            if (!supp) return;
            
            const modal = document.createElement('div');
            modal.className = 'supplement-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="modal-close" onclick="this.parentElement.parentElement.remove()">√ó</button>
                    <div class="modal-header">
                        <div class="modal-icon">${supp.icon}</div>
                        <h2>${supp.name}</h2>
                        <p>${supp.shortDesc}</p>
                    </div>
                    <div class="modal-body">
                        <div class="modal-section">
                            <h3>‚ú® Benefits</h3>
                            <ul>
                                ${supp.benefits.map(b => `<li>${b}</li>`).join('')}
                            </ul>
                        </div>
                        <div class="modal-section">
                            <h3>‚è∞ When to Take</h3>
                            <p>${supp.timing}</p>
                        </div>
                        <div class="modal-section">
                            <h3>üíä Recommended Dosage</h3>
                            <p>${supp.dosage}</p>
                        </div>
                        <div class="modal-section">
                            <h3>üéØ Best For</h3>
                            <p>${supp.bestFor.join(', ')}</p>
                        </div>
                        <div class="modal-section">
                            <h3>‚ö†Ô∏è Safety</h3>
                            <p>${supp.safety}</p>
                        </div>
                        <div class="modal-section">
                            <h3>üî¨ Science</h3>
                            <p>${supp.science}</p>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Initialize
        window.addEventListener('DOMContentLoaded', () => {
            generateAIRecommendations();
        });
    </script>
</body>
</html>
