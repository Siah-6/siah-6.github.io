<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MESY - Event Info Page</title>
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Event Details" />
    <meta property="og:description" content="Event Information" />
    <meta property="og:image" content="" />
    <meta property="og:url" content="" />
    <meta name="twitter:card" content="summary_large_image">
    <link rel="icon" href="assets/img/logo.svg" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/eventInfoPage.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>

<body>
    <!-- Guest Navigation Bar (exact copy from PHP) -->
    <style>
        a {
            text-decoration: none;
        }

        .navbar {
            background-color: #FE5722;
        }

        .border-active {
            border-color: #FE5722 !important;
        }
    </style>

    <nav class="navbar navbar-expand-lg p-2 position-relative z-1">
        <div class="container-fluid">
            <div class="w-100 d-flex align-items-center justify-content-between">

                <button class="btn text-dark fs-3 ms-3" data-bs-toggle="offcanvas" data-bs-target="#sideNavbar"
                    aria-controls="sideNavbar">
                    &#9776;
                </button>

                <div class="position-absolute start-50 translate-middle-x d-flex align-items-center gap-2">
                    <img src="assets/img/logo.svg" alt="logo" style="height: 60px;">
                </div>

                <div class="d-flex align-items-center gap-2 me-3">
                    <a href="login.html" class="btn btn-md p-2 rounded-3 ps-3 pe-3 d-none d-lg-inline"
                        style="background-color: #D9D9D9;">
                        Log In
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="offcanvas offcanvas-start" tabindex="-1" id="sideNavbar" aria-labelledby="sideNavbarLabel">
        <div class="offcanvas-header" style="background-color: #FE5722;">
            <img src="assets/img/logo.svg" class="me-2" alt="logo" style="height: 60px;">
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <ul class="nav flex-column">
                <li class="nav-item"><a class="nav-link text-decoration-none text-dark fw-semibold"
                        href="index.html">Upcoming Events</a></li>
            </ul>
        </div>
    </div>

    <div class="container">
        <div class="row m-0">
            <div class="col-12 col-lg-6 vh-100 top-0" style="overflow: scroll;">
                <div class="row px-0">
                    <div class="col mt-5">
                        <img id="eventImage" src="assets/uploads/Summer.jpg" alt="Event Image"
                            class="img-fluid" style="width: 100%;">
                    </div>
                </div>
                <div class="row m-0">
                    <div class="col mt-3 pb-2 mx-0" data-bs-toggle="modal" data-bs-target="#shareLinkModal"
                        style="border-bottom: solid 2px var(--c-primary-orange);">
                        <i class="fas fa-share-alt fa-2x"></i>
                    </div>
                </div>

                <!-- Share Modal -->
                <div class="modal fade" id="shareLinkModal" tabindex="-1" aria-labelledby="shareLinkModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="shareLinkModalLabel">Share Event</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <div class="input-group mb-3">
                                    <input type="text" class="form-control" id="shareLink" readonly>
                                    <button class="btn btn-outline-secondary" type="button" onclick="copyShareLink()">Copy</button>
                                </div>
                                <div class="d-flex justify-content-center gap-3">
                                    <button class="btn btn-primary" onclick="shareOnFacebook()">
                                        <i class="fab fa-facebook-f"></i> Facebook
                                    </button>
                                    <button class="btn btn-info" onclick="shareOnTwitter()">
                                        <i class="fab fa-twitter"></i> Twitter
                                    </button>
                                    <button class="btn btn-success" onclick="shareOnWhatsApp()">
                                        <i class="fab fa-whatsapp"></i> WhatsApp
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-12 col-lg-6 pb-4 phoneDisplay"
                    style="display: none; border-bottom: solid 2px var(--c-primary-orange);">
                    <div class="row">
                        <div class="col">
                            <h1 class="mt-5" id="eventTitlePhone" style="font-family: var(--ff-title); font-weight: bold;">
                                TechChika with Campus DEVCON
                            </h1>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col d-flex flex-row mb-3">
                            <i class="fas fa-calendar fa-2x"></i>
                            <div class="h5 mx-3" id="eventDateTimePhone" style="font-family: var(--ff-title);">
                                December 15, 2024 | 2:00 PM
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col d-flex flex-row">
                            <i class="fas fa-map-marker-alt fa-2x"></i>
                            <div class="h5 mx-3" id="eventLocationPhone" style="font-family: var(--ff-title);">
                                Manila
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="h6 pt-5 ps-2 m-0" style="border-bottom: solid 2px var(--c-primary-orange);">
                                Organized By:
                            </div>
                        </div>
                    </div>
                    <div class="row m-0">
                        <div class="col d-flex flex-column mt-1 pb-5"
                            style="border-bottom: solid 2px var(--c-primary-orange);">
                            <div id="organizerNamePhone">Campus DEVCON</div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col">
                            <div class="row">
                                <div class="col-6 col-lg-4">
                                    <div class="h6 p-2"
                                        style="border: solid 2px var(--c-primary-orange); border-top: none;">
                                        Registration
                                    </div>
                                </div>
                            </div>
                            <div class="row m-0">
                                <div class="col mt-3 pb-3 mx-0 text-center">
                                    Welcome! To join the event, please register below.
                                </div>
                            </div>
                            <div class="row">
                                <div class="col text-center">
                                    <button class="btn"
                                        style="background-color: var(--c-primary-orange); color: white; border-radius: 0;"
                                        data-bs-toggle="modal" data-bs-target="#organizerAlertModal">
                                        Register Now
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-4">
                        <div class="h6 p-2" style="border: solid 2px var(--c-primary-orange); border-top: none;">
                            About the Event
                        </div>
                    </div>
                </div>
                <div class="row m-0">
                    <div class="col mt-3 pb-3 mx-0" style="border-bottom: solid 2px var(--c-primary-orange);">
                        <span id="eventDescription">Join us for an exciting tech talk and networking event featuring the latest innovations in web development and AI.</span>
                    </div>
                </div>
                <div class="row">
                    <div class="col-4">
                        <div class="h6 p-2" style="border: solid 2px var(--c-primary-orange); border-top: none;">
                            Location
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="h5 mt-3 pt-2 px-2" id="eventLocationDetail" style="font-family: var(--ff-title);">
                            Manila
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col pt-3 pb-5 mb-5">
                        <div id="map"></div>
                    </div>
                </div>
            </div>

            <div class="col-12 col-lg-6 vh-100 top-0 desktopDisplay">
                <div class="row">
                    <div class="col">
                        <h1 class="mt-5" id="eventTitleDesktop" style="font-family: var(--ff-title); font-weight: bold;">
                            TechChika with Campus DEVCON
                        </h1>
                    </div>
                </div>
                <div class="row">
                    <div class="col d-flex flex-row mb-3">
                        <i class="fas fa-calendar fa-2x"></i>
                        <div class="h5 mx-3" id="eventDateTimeDesktop" style="font-family: var(--ff-title);">
                            December 15, 2024 | 2:00 PM
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col d-flex flex-row">
                        <i class="fas fa-map-marker-alt fa-2x"></i>
                        <div class="h5 mx-3" id="eventLocationDesktop" style="font-family: var(--ff-title);">
                            Manila
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="h6 pt-5 ps-2 m-0" style="border-bottom: solid 2px var(--c-primary-orange);">
                            Organized By:
                        </div>
                    </div>
                </div>
                <div class="row m-0">
                    <div class="col d-flex flex-column mt-1 pb-5"
                        style="border-bottom: solid 2px var(--c-primary-orange);">
                        <div id="organizerNameDesktop">Campus DEVCON</div>
                    </div>
                </div>

                <div class="row">
                    <div class="col">
                        <div class="row">
                            <div class="col-4">
                                <div class="h6 p-2"
                                    style="border: solid 2px var(--c-primary-orange); border-top: none;">
                                    Registration
                                </div>
                            </div>
                        </div>
                        <div class="row m-0">
                            <div class="col mt-3 pb-3 mx-0 text-center">
                                Welcome! To join the event, please register below.
                            </div>
                        </div>
                        <div class="row">
                            <div class="col text-center">
                                <a href="attendEventsForm.html?eventId=1" class="btn register-now-btn"
                                    style="background-color: var(--c-primary-orange); color: white; border-radius: 0; text-decoration: none;">
                                    Register Now
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="organizerAlertModal" tabindex="-1" aria-labelledby="organizerAlertModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center">
                <div class="modal-header">
                    <h5 class="modal-title" id="organizerAlertModalLabel">Action Not Allowed</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    You are currently logged in as an <strong>organizer</strong>. You cannot register for an event while
                    using an organizer account.
                </div>
                <div class="modal-footer justify-content-center">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Okay</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="assets/js/data.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        let currentEvent = null;
        let map;

        document.addEventListener('DOMContentLoaded', function() {
            loadEventDetails();
            initializeMap();
        });

        function loadEventDetails() {
            // Get event ID from URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const eventId = urlParams.get('eventId');

            if (!eventId) {
                currentEvent = sampleEvents[0];
            } else {
                currentEvent = sampleEvents.find(event => event.id == eventId);
            }

            if (!currentEvent) {
                alert('Event not found');
                window.location.href = 'index.html';
                return;
            }

            // Update all event details
            updateEventDetails();
        }

        function updateEventDetails() {
            const eventDate = new Date(currentEvent.eventDate);
            const formattedDate = eventDate.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            const timeRange = formatTime(currentEvent.startTime);

            // Update phone display
            document.getElementById('eventTitlePhone').textContent = currentEvent.eventName;
            document.getElementById('eventDateTimePhone').textContent = `${formattedDate} | ${timeRange}`;
            document.getElementById('eventLocationPhone').textContent = currentEvent.location;
            document.getElementById('organizerNamePhone').textContent = currentEvent.organizerName;

            // Update desktop display
            document.getElementById('eventTitleDesktop').textContent = currentEvent.eventName;
            document.getElementById('eventDateTimeDesktop').textContent = `${formattedDate} | ${timeRange}`;
            document.getElementById('eventLocationDesktop').textContent = currentEvent.location;
            document.getElementById('organizerNameDesktop').textContent = currentEvent.organizerName;

            // Update shared elements
            document.getElementById('eventDescription').textContent = currentEvent.description;
            document.getElementById('eventLocationDetail').textContent = currentEvent.location;

            // Update event image
            const eventImage = document.getElementById('eventImage');
            if (currentEvent.eventImage) {
                eventImage.src = `assets/uploads/${currentEvent.eventImage}`;
            } else {
                eventImage.src = 'assets/uploads/Summer.jpg'; // Default image
            }

            // Update share link
            document.getElementById('shareLink').value = window.location.href;

            // Update register now link with correct event ID
            const registerBtn = document.querySelector('.register-now-btn');
            if (registerBtn) {
                registerBtn.href = `attendEventsForm.html?eventId=${currentEvent.id}`;
            }
        }

        function formatTime(timeString) {
            const [hours, minutes] = timeString.split(':');
            const hour = parseInt(hours);
            const ampm = hour >= 12 ? 'PM' : 'AM';
            const hour12 = hour % 12 || 12;
            return `${hour12}:${minutes} ${ampm}`;
        }

        function initializeMap() {
            const lat = currentEvent.latitude || 14.5995;
            const lng = currentEvent.longitude || 120.9842;

            map = L.map('map').setView([lat, lng], 13);

            L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            L.marker([lat, lng]).addTo(map)
                .bindPopup(currentEvent.eventName)
                .openPopup();
        }

        function copyShareLink() {
            const shareLink = document.getElementById('shareLink');
            shareLink.select();
            document.execCommand('copy');
            alert('Link copied to clipboard!');
        }

        function shareOnFacebook() {
            const url = encodeURIComponent(window.location.href);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
        }

        function shareOnTwitter() {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent(`Check out this event: ${currentEvent.eventName}`);
            window.open(`https://twitter.com/intent/tweet?url=${url}&text=${text}`, '_blank');
        }

        function shareOnWhatsApp() {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent(`Check out this event: ${currentEvent.eventName}`);
            window.open(`https://wa.me/?text=${text} ${url}`, '_blank');
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous">
    </script>
</body>

</html>
