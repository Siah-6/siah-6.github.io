<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>MESY | Attend Event Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <link rel="icon" href="../assets/img/logo.svg" type="image/x-icon">
    <link rel="stylesheet" href="../assets/css/attendEventForm.css">
</head>

<body>
    <!-- Navbar -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-calendar-alt"></i>
                    </div>
                    <div>
                        <div class="logo-title">MESY</div>
                        <div class="logo-subtitle">Event Management System</div>
                    </div>
                </div>
                <nav class="nav-mid">
                    <a class="nav-link fw-semibold text-dark" href="../index.html">Events</a>
                </nav>
                <div class="header-actions">
                    <a href="../login.html" class="btn btn-ghost">Log In</a>
                    <a href="../signup.html" class="btn btn-primary">Sign Up</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Side NavBar -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="sideNavbar" aria-labelledby="sideNavbarLabel">
        <div class="offcanvas-header" style="background-color: #FE5722;">
            <img src="../assets/img/logo.svg" class="me-2" alt="logo" style="height: 60px;">
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <ul class="nav flex-column">
                <li class="nav-item"><a class="nav-link text-decoration-none text-dark fw-semibold"
                        href="../index.html">Home</a></li>
                <li class="nav-item"><a class="nav-link text-decoration-none text-dark fw-semibold"
                        href="archivedEvent.html">Archived Events</a></li>
                <li class="nav-item"><a class="nav-link text-decoration-none text-dark fw-semibold"
                        href="index.html">Ongoing Events</a></li>
                <li class="nav-item"><a class="nav-link text-decoration-none text-dark fw-semibold"
                        href="../index.html">Upcoming Events</a></li>
            </ul>
        </div>
    </div>

    <div class="container-fluid mainContainer px-3 py-3">
        <!-- Event Details -->
        <div class="container-fluid borderColor p-3 my-4">
            <h2 class="p-3"><b>Event:</b> <span id="eventTitle">ByteForward: The Innovation Forum</span></h2>
            <div class="container-fluid d-flex flex-row align-items-start justify-content-start">
                <img class="img-fluid calendarIcon m-2" src="../assets/img/calendar.svg" alt="calendar">
                <p class="m-2" id="eventDateTime">June 6, 2025 @ 8:00 AM - 3:00 PM</p>
            </div>

            <div class="container-fluid d-flex flex-row align-items-start justify-content-start">
                <img class="img-fluid locationIcon m-2" src="../assets/img/location.svg" alt="location">
                <p class="m-2" id="eventLocation">Lipa City, Batangas</p>
            </div>
        </div>
        
        <form id="attendEventForm">

          <!-- Personal Details -->
<div class="container-fluid borderColor p-3 my-4">
    <h2 class="p-2"><b>Personal Details</b></h2>
    <div class="row p-2">
        <div class="col-9 col-sm-9 col-md-4 col-lg-4 col-xl-4 order-0 order-sm-0 order-md-0 py-2">
            <label for="firstName" class="form-label"><b>First Name:</b></label>
            <input type="text" name="firstName" class="form-control" id="firstName" placeholder="First Name" required>
        </div>
        <div class="col-9 col-sm-9 col-md-4 col-lg-4 col-xl-4 order-2 order-sm-2 order-md-1 py-2">
            <label for="lastName" class="form-label"><b>Last Name:</b></label>
            <input type="text" name="lastName" class="form-control" id="lastName" placeholder="Last Name" required>
        </div>
        <div class="col-3 col-sm-3 col-md-4 col-lg-4 col-xl-4 order-1 order-sm-1 order-md-2 py-2">
            <label for="suffix" class="form-label"><b>Suffix:</b></label>
            <input type="text" name="suffixName" class="form-control" id="suffix" placeholder="Suffix (ex. Jr., II, etc.)">
        </div>
    </div>
    <div class="row p-2">
        <div class="col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 py-2">
            <label for="email" class="form-label"><b>Email:</b></label>
            <input type="email" name="email" class="form-control" id="email" placeholder="Email" required>
        </div>
        <div class="col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 py-2">
            <label for="age" class="form-label"><b>Age:</b></label>
            <input type="text" name="age" class="form-control" id="age" placeholder="Age" maxlength="2" required>
        </div>
        <div class="col-12 col-sm-12 col-md-4 col-lg-4 col-xl-4 py-2">
            <label for="number" class="form-label"><b>Phone Number:</b></label>
            <input type="tel" name="phoneNumber" class="form-control" id="number" placeholder="Phone Number" maxlength="11" required>
        </div>
    </div>
    <div class="row p-2">
        <div class="col-12 py-1">
            <label for="provinceSelect" class="form-label"><b>Address</b></label>
        </div>
        <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 py-2">
            <select class="form-select" name="provinceSelect" id="provinceSelect" required>
                <option selected disabled value="">Select a Province</option>
            </select>
        </div>
        <div class="col-12 col-sm-12 col-md-6 col-lg-6 col-xl-6 py-2">
            <select class="form-select" name="citySelect" id="citySelect" required>
                <option selected disabled value="">Select a City</option>
            </select>
        </div>
    </div>
</div>


            <!--Questionnaire-->
            <div class="container-fluid borderColor p-3 my-4">
                <h2 class="p-2"><b>Questionnaire</b></h2>

                <!-- Sample Questions (replaces PHP dynamic questions) -->
                <div class="container-fluid p-3">
                    <h4 class="py-2"><b>What is your profession?</b></h4>
                    <input type="text" class="form-control" name="question1" placeholder="Please specify">
                </div>

                <div class="container-fluid p-3">
                    <h4 class="py-2"><b>How did you hear about this event?</b></h4>
                    <input type="text" class="form-control" name="question2" placeholder="Please specify">
                </div>

                <div class="container-fluid p-3">
                    <h4 class="py-2"><b>What do you hope to learn from this event?</b></h4>
                    <input type="text" class="form-control" name="question3" placeholder="Please specify">
                </div>

            </div>

            <!-- Consent -->
            <div class="container-fluid p-4">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="termsCheck" id="termsAndConditions" required>
                    <label class="form-check-label" for="termsAndConditions">
                        <b>I agree to the <a href="../privacyAndPolicy.html">terms and privacy policy</a></b>
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" value="sendUpdates" name="sendUpdates" id="sendUpdates">
                    <label class="form-check-label" for="sendUpdates">
                        <b>Send me updates about this event</b>
                    </label>
                </div>
            </div>

            <div class="container-fluid d-flex flex-row justify-content-center align-items-center p-3">
                <button class="btn btn-lg btnRegister" name="registerButton" type="submit"><b>Register</b></button>
            </div>

        </form>

    </div>

    <!-- JavaScript -->
    <script src="../assets/js/data.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
        crossorigin="anonymous"></script>
    <script>
        let currentEvent = null;

        document.addEventListener('DOMContentLoaded', function() {
            loadEventDetails();
            loadProvinces();
            loadCities();
            checkifProvinceSelected();
        });

        function loadEventDetails() {
            // Get event ID from URL parameters
            const urlParams = new URLSearchParams(window.location.search);
            const eventId = urlParams.get('eventId');

            if (!eventId) {
                // Default event if no ID provided
                currentEvent = sampleEvents[0];
            } else {
                currentEvent = sampleEvents.find(event => event.id == eventId);
            }

            if (currentEvent) {
                document.getElementById('eventTitle').textContent = currentEvent.eventName;
                
                const eventDate = new Date(currentEvent.eventDate);
                const formattedDate = eventDate.toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                const timeRange = formatTime(currentEvent.startTime) + ' - ' + formatTime(currentEvent.endTime);
                
                document.getElementById('eventDateTime').textContent = `${formattedDate} @ ${timeRange}`;
                document.getElementById('eventLocation').textContent = currentEvent.location;
            }
        }

        function formatTime(timeString) {
            const [hours, minutes] = timeString.split(':');
            const hour = parseInt(hours);
            const ampm = hour >= 12 ? 'PM' : 'AM';
            const hour12 = hour % 12 || 12;
            return `${hour12}:${minutes} ${ampm}`;
        }

        // Philippines provinces and cities data
        const provinces = [
            "Metro Manila", "Luzon", "Visayas", "Mindanao"
        ];

        const cities = {
            "Metro Manila": ["Manila", "Quezon City", "Caloocan", "Makati", "Pasay", "Pasig", "Mandaluyong", "San Juan", "Las Piñas", "Muntinlupa", "Parañaque", "Marikina", "Taguig", "Malabon", "Navotas", "Valenzuela", "San Jose del Monte", "Makati City"],
            "Luzon": ["Baguio", "Angeles City", "Batangas City", "Lipa City", "San Fernando", "Cabuyao", "San Pedro", "Biñan", "Santa Rosa", "Calamba", "Laoag", "Legazpi", "Lucena", "Tarlac City", "Tuguegarao", "San Pablo", "Cabanatuan", "Meycauayan", "Puerto Princesa"],
            "Visayas": ["Cebu City", "Mandaue", "Lapu-Lapu", "Iloilo City", "Bacolod", "Tacloban", "Ormoc", "Bayawan", "Kabankalan", "Canlaon", "Bais", "Dumaguete", "Maasin", "Roxas City", "Passi"],
            "Mindanao": ["Davao City", "Cagayan de Oro", "General Santos", "Zamboanga City", "Antipolo", "Butuan", "Cotabato City", "Iligan", "Surigao", "Pagadian", "Kidapawan", "Digos", "Tagum", "Panabo", "Samal", "Sarangani", "Koronadal", "Tandag"]
        };

        function loadProvinces() {
            const provinceSelect = document.getElementById('provinceSelect');
            provinces.forEach(province => {
                const option = document.createElement('option');
                option.value = province;
                option.textContent = province;
                provinceSelect.appendChild(option);
            });
        }

        function loadCities() {
            const provinceSelect = document.getElementById('provinceSelect');
            const citySelect = document.getElementById('citySelect');
            
            provinceSelect.addEventListener('change', function() {
                const selectedProvince = this.value;
                citySelect.innerHTML = '<option selected disabled value="">Select a City</option>';
                
                if (selectedProvince && cities[selectedProvince]) {
                    cities[selectedProvince].forEach(city => {
                        const option = document.createElement('option');
                        option.value = city;
                        option.textContent = city;
                        citySelect.appendChild(option);
                    });
                }
            });
        }

        function checkifProvinceSelected() {
            const provinceSelect = document.getElementById('provinceSelect');
            const citySelect = document.getElementById('citySelect');
            
            provinceSelect.addEventListener('change', function() {
                if (this.value) {
                    citySelect.removeAttribute('disabled');
                } else {
                    citySelect.setAttribute('disabled', 'disabled');
                }
            });
            
            // Initially disable city select
            citySelect.setAttribute('disabled', 'disabled');
        }

        // Handle form submission
        document.getElementById('attendEventForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());
            
            // Add event information
            data.eventId = currentEvent ? currentEvent.id : null;
            data.eventName = currentEvent ? currentEvent.eventName : 'Unknown Event';
            data.registrationDate = new Date().toISOString();

            // Store registration in localStorage
            const registrations = JSON.parse(localStorage.getItem('eventRegistrations') || '[]');
            registrations.push(data);
            localStorage.setItem('eventRegistrations', JSON.stringify(registrations));

            alert('Registration successful! You will receive a confirmation email shortly.');
            window.location.href = '../index.html';
        });
    </script>
</body>

</html>
