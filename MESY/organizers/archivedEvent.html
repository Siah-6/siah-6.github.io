<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>MESY | Archieved Events</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="../assets/img/logo.svg" type="image/x-icon">
    <link rel="stylesheet" href="../assets/css/archivedEvent.css">
</head>

<body>
    <!-- Organizer Navigation Bar (exact copy from PHP) -->
    <style>
        a {
            text-decoration: none;
        }

        .navbar {
            background-color: #FE5722;
        }

        .border-active {
            border-color: #FE5722 !important;
        }
    </style>

    <nav class="navbar navbar-expand-lg p-2 position-relative z-1">
        <div class="container-fluid">
            <div class="w-100 d-flex align-items-center justify-content-between">

                <button class="btn text-dark fs-3 ms-3" data-bs-toggle="offcanvas" data-bs-target="#sideNavbar"
                    aria-controls="sideNavbar">
                    &#9776;
                </button>

                <div class="position-absolute start-50 translate-middle-x d-flex align-items-center gap-2">
                    <img src="../assets/img/logo.svg" alt="logo" style="height: 60px;">
                </div>

                <div class="d-flex align-items-center gap-2 me-3">

                    <a href="eventForm.html">
                        <button class="btn btn-md p-2 rounded-3 ps-3 pe-3 d-none d-lg-inline text-white"
                            style="background-color: #E7400C;">Add
                            Event
                        </button>
                    </a>
                    <a href="#" onclick="logout()" class="btn btn-md p-2 rounded-3 ps-3 pe-3 d-none d-lg-inline"
                        style="background-color: #D9D9D9;">
                        Log Out
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="offcanvas offcanvas-start" tabindex="-1" id="sideNavbar" aria-labelledby="sideNavbarLabel">
        <div class="offcanvas-header" style="background-color: #FE5722;">
            <img src="../assets/img/logo.svg" class="me-2" alt="logo" style="height: 60px;">

            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <ul class="nav flex-column">
                <li class="nav-item"><a class="nav-link text-decoration-none text-dark fw-semibold"
                        href="index.html">Home</a></li>
                <li class="nav-item"><a class="nav-link text-decoration-none text-dark fw-semibold"
                        href="archivedEvent.html">Archived Events</a></li>
                <li class="nav-item"><a class="nav-link text-decoration-none text-dark fw-semibold" href="myEvents.html">My
                        Events</a></li>
            </ul>
            <hr class=" d-lg-none"style="border-top: 2px solid #FE5722;">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link text-decoration-none text-dark fw-semibold d-lg-none" href="eventForm.html">Add Event</a>
                </li>
                <li class="nav-item">
                    <a class=" nav-link text-decoration-none text-dark fw-semibold d-lg-none" href="#" onclick="logout()">Log Out</a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Contents -->

    <div class="text-center m-5" style="color: #FE5722; font-size: 4rem; font-family: Belove;">Events</div>

    <div class="container-fluid">
        <div class="d-flex align-items-center gap-3 mt-3 flex-wrap justify-content-center">
            <a href="archivedEvent.html" class="btn btn-sm px-2 py-1 text-danger border-0 fw-bold" style="font-size: 1.2rem; background: none;">&times;</a>
                <form method="get" class="d-flex align-items-center">
                    <div class="search-box d-flex align-items-center px-3 py-1 rounded-pill" style="background-color: #D9D9D9;">
                    <input type="text" name="search" class="form-control bg-transparent" placeholder="Search" style="width: 120px;" value="">
                        <button type="submit" class="btn p-0 text-decoration-none text-dark">
                            <i class="fas fa-search text-muted"></i>
                        </button>
                    </div>
                </form>
            <nav class="nav mx-auto mx-md-0 gap-4 justify-content-center">
                        <a class="nav-link fw-semibold text-dark" href="index.html">Upcoming</a>
                        <a class="nav-link fw-semibold text-dark border-bottom border-2 border-active" href="#">Archived</a>
                        <div class="dropdown ms-auto mx-auto d-block d-md-flex justify-content-md-end mt-2 mt-md-0">
                            <button class="btn dropdown-toggle rounded-pill-2 text-white px-3" type="button" data-bs-toggle="dropdown"
                            aria-expanded="false" style="background-color: #FE5722"> All
                            </button>
                            <ul class="dropdown-menu">
                                <li>
                                <a class="dropdown-item" href="?">All</a>
                                </li>
                                <li>
                                <a class="dropdown-item" href="?year=2024">2024</a>
                                </li>
                                <li>
                                <a class="dropdown-item" href="?year=2023">2023</a>
                                </li>
                            </ul>
                        </div>
            </nav>
        </div>
    </div>

    <div class="container-fluid mt-3 mb-2">
        <div class="custom-scrollbar-wrapper text-center">
            <!-- Archived events will be dynamically loaded here -->
            <div id="archivedEventsContainer">
                <!-- Events will be rendered here -->
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="../assets/js/data.js"></script>
    <script>
        let archivedEvents = [];

        document.addEventListener('DOMContentLoaded', function() {
            if (!session.requireAuth()) {
                return;
            }

            loadArchivedEvents();
        });

        function loadArchivedEvents() {
            // Use sampleEvents as archived events since sampleArchivedEvents might not exist
            archivedEvents = sampleEvents.filter(event => {
                const eventDate = new Date(event.eventDate);
                return eventDate < new Date();
            });

            // Add some demo archived events if none exist
            if (archivedEvents.length === 0) {
                archivedEvents = [
                    {
                        id: 2001,
                        eventName: "Summer Coding Bootcamp 2024",
                        category: "Workshops & Training",
                        description: "Intensive 3-week coding bootcamp covering web development, mobile apps, and cloud computing.",
                        eventDate: "2024-06-15",
                        startTime: "09:00",
                        endTime: "17:00",
                        location: "Manila",
                        organizerName: session.currentUser.name || session.currentUser.username,
                        organizerId: session.currentUser.organizerId,
                        eventImage: "Summer.jpg"
                    },
                    {
                        id: 2002,
                        eventName: "Jazz Night Under the Stars",
                        category: "Concerts & Music",
                        description: "An evening of smooth jazz featuring renowned local and international jazz artists.",
                        eventDate: "2024-08-20",
                        startTime: "19:00",
                        endTime: "23:00",
                        location: "Alabang",
                        organizerName: session.currentUser.name || session.currentUser.username,
                        organizerId: session.currentUser.organizerId,
                        eventImage: "festival.jpg"
                    }
                ];
            }

            renderArchivedEvents();
        }

        function renderArchivedEvents() {
            const container = document.getElementById('archivedEventsContainer');
            
            if (archivedEvents.length === 0) {
                container.innerHTML = '<div class="text-center p-5">No archived events found.</div>';
                return;
            }

            container.innerHTML = archivedEvents.map(event => createArchivedEventCard(event)).join('');
        }

        function createArchivedEventCard(event) {
            const date = new Date(event.eventDate);
            const day = date.getDate();
            const month = date.toLocaleDateString('en-US', { month: 'short' });
            const time = formatTime(event.startTime);

            return `
                <a href="eventInfoPage.html?eventId=${event.id}" class="text-decoration-none text-dark">
                <div class="d-flex justify-content-center"></div>
                <div class="row align-items-center justify-content-center m-5 g-4 event-hover">
                    <div class="col-12 col-md-2 text-center">
                        <h1 style="color:#FE5722">${day}</h1>
                        <h3 class="text-dark">${month}</h3>
                    </div>

                <div class="col-12 col-md-7 text-center">
                    <h5 class="fw-bold mb-1">${event.eventName}</h5>
                    <p class="mb-1 fs-6 fs-md-5">${event.description}</p>
                    <small class="text-muted">
                        Location: ${event.location} | 
                        Time: ${time}
                    </small>
                </div>

                <div class="col-12 col-md-3">
                    <div class="card mx-auto" style="max-width: 300px;">
                        <img src="../assets/uploads/${event.eventImage || 'Summer.jpg'}" class="card-img-top" alt="Event Image">
                        <div class="card-body p-2">
                            <p class="card-text text-center small">View Details</p>
                        </div>
                    </div>
                </div>
            </div>
            </div>
            </a>
            `;
        }

        function formatTime(timeString) {
            const [hours, minutes] = timeString.split(':');
            const hour = parseInt(hours);
            const ampm = hour >= 12 ? 'PM' : 'AM';
            const hour12 = hour % 12 || 12;
            return `${hour12}:${minutes} ${ampm}`;
        }

        function logout() {
            session.logout();
            window.location.href = '../login.html';
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous">
    </script>
</body>

</html>
