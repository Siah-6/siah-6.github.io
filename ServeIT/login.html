<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="assets/css/login/style.css">
    <link rel="icon" href="assets/images/nav/logo-nav.png">

    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>ServeIT | Login</title>

</head>

<body>
    <div class="container-fluid ">
        <div class="row pt-5 pb-3">
            <div class="col-2">

            </div>
            <div class="col-8 text-center">
                <img src="assets/images/login/logoST.png" class="img-fluid" alt="Logo" style="height: 50px">
            </div>
            <div class="col-2">

            </div>
        </div>
    </div>

    <div class="container pb-3" id="error-container" style="display: none; min-height: 50px; padding-top: 10px;background-color:transparent;box-shadow: none !important;">
        <div class="alert alert-danger" id="error-message">
            <!-- Error messages will be shown here -->
        </div>
    </div>

    <div class="container" id="container">
        <div class="form-container sign-up">
            <form id="register-form">
                <h1>Create Account</h1>
                <div class="demo-note alert alert-info mb-3">
                    <small><i class="fas fa-info-circle"></i> Demo Mode: Any credentials will work for registration!</small>
                </div>
                <span>Enter the details needed.</span>
                <input type="text" placeholder="Username" name="username" id="register-username" required>
                <input type="email" placeholder="Email" name="email" id="register-email" required>
                <input type="text" placeholder="Phone Number" name="phoneNumber" id="register-phone" required>
                <input type="password" placeholder="Password" name="registerPassword" id="register-password" required>
                <input type="password" placeholder="Confirm Password" name="cpassword" id="register-cpassword" required>
                <button type="submit">Sign Up</button>
            </form>
        </div>
        <div class="form-container sign-in">
            <form id="login-form">
                <h1>Log In</h1>
                <div class="demo-note alert alert-info mb-3">
                    <small><i class="fas fa-info-circle"></i> Demo Mode: Any credentials will work for login!</small>
                </div>
                <label class="mt-3" for="uname" class="form-label">Username | Email | Phone</label>
                <input type="text" id="uname" class="form-control" name="uname" placeholder="Username" required>
                <label class="mt-3" for="password" class="form-label">Password</label>
                <input type="password" id="password" class="form-control" name="password" placeholder="Password" required>
                <button type="submit">Sign In</button>
            </form>
        </div>
        <div class="toggle-container">
            <div class="toggle">
                <div class="toggle-panel toggle-left">
                    <h1>Welcome to ServeIT!</h1>
                    <p>Register your personal details to use all of site features.</p>
                    <button class="hidden" id="login">Sign In</button>
                </div>
                <div class="toggle-panel toggle-right">
                    <h1>Hello, Friend!</h1>
                    <p>Enter your account details to use all of site features.</p>
                    <button class="hidden" id="register">Sign Up</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-QWtLqnHreEpfYRhI2zdzZyLvHbEu4BQ/bBcT7MsftkDQbdfDlOr/XR+Mh2nQ03g" crossorigin="anonymous">
    </script>

    <script src="assets/js/login/script.js"></script>
    <script src="js/data.js"></script>
    <script src="js/session.js"></script>
    <script>
        // Handle login form submission
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('uname').value;
            const password = document.getElementById('password').value;
            
            const result = sessionManager.login(username, password);
            
            if (result.success) {
                // Redirect based on user role
                if (result.user.role === 'admin') {
                    window.location.href = 'admin/index.html';
                } else {
                    window.location.href = 'index.html';
                }
            } else {
                showError(result.error || 'Login failed. Please try again.');
            }
        });

        // Handle registration form submission
        document.getElementById('register-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('register-username').value;
            const email = document.getElementById('register-email').value;
            const phoneNumber = document.getElementById('register-phone').value;
            const password = document.getElementById('register-password').value;
            const cpassword = document.getElementById('register-cpassword').value;
            
            // Validate passwords match
            if (password !== cpassword) {
                showError('PASSWORD UNMATCHED');
                return;
            }
            
            const result = sessionManager.register(username, email, password, phoneNumber);
            
            if (result.success) {
                window.location.href = 'index.html';
            } else {
                showError(result.error);
            }
        });

        // Function to show error messages
        function showError(message) {
            const errorContainer = document.getElementById('error-container');
            const errorMessage = document.getElementById('error-message');
            
            errorMessage.textContent = message;
            errorContainer.style.display = 'block';
            
            // Hide error after 5 seconds
            setTimeout(() => {
                errorContainer.style.display = 'none';
            }, 5000);
        }

        // Check if user is already logged in
        document.addEventListener('DOMContentLoaded', function() {
            if (sessionManager.isLoggedIn()) {
                const currentUser = sessionManager.getCurrentUser();
                if (currentUser.role === 'admin') {
                    window.location.href = 'admin/index.html';
                } else {
                    window.location.href = 'index.html';
                }
            }
        });
    </script>
    <!-- icons -->
    <script src="https://kit.fontawesome.com/d3ed67e674.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <!-- scroll animation  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.min.js"></script>
    <script>
        new WOW({
            offset: 200,
            mobile: true,
        }).init();
    </script>
    <script src="sharedAssets/darkmode.js"></script>
    <script src="js/data.js"></script>
    <script src="js/session.js"></script>
    <script src="js/main.js"></script>
</body>

</html>
